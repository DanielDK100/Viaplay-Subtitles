var manifest=chrome.runtime.getManifest(),doc=document,movieQuotes=["I'm going to make him an offer he can't refuse.","May the Force be with you.","Mama always said life was like a box of chocolates. You never know what you're gonna get.","The first rule of Fight Club is you do not talk about Fight Club.","Houston, we have a problem.","Say hello to my little friend!","Snakes. Why'd it have to be snakes?","I see dead people.","Elementary, my dear Watson.","To infinity and beyond!"],vsBackground="vs_background",vsText="vs_text",vsStyle="vs-style";function initializeMessageListener(n,r,s){chrome.runtime.onMessage.addListener(function(e,o,t){e.color&&(chrome.storage.sync.get([n,r],function(e){doc.querySelector("#"+s).innerHTML=setStyles(e)}),logColor(e.color))})}function setManifestData(o){doc.querySelector("#vs-container")&&(doc.querySelectorAll(".vs-title").forEach(function(e){e.textContent=o.name}),doc.querySelector(".vs-icon").src=o.icons[128],doc.querySelector(".vs-icon").alt=o.name,doc.querySelector(".vs-version").textContent=o.version)}function setMovieQuote(e,o){if(e){var t=o[Math.floor(Math.random()*o.length)];e.textContent=t}}function setPopupColors(e,o){var t=doc.head;if(t){var n=doc.createElement("style");n.type="text/css",n.id=e,n.appendChild(doc.createTextNode(setStyles(o))),t.appendChild(n)}}function initializeColorPicker(e,o,t){new Picker({parent:e,popup:"bottom",color:o,onDone:function(o){var e={};e[t]=o.hex,chrome.storage.sync.set(e,function(){chrome.storage.sync.get([vsBackground,vsText],function(e){doc.querySelector("#"+vsStyle).innerHTML=setStyles(e),chrome.tabs.query({url:"*://*/*"},function(e){e&&e.forEach(function(e){chrome.tabs.sendMessage(e.id,{color:o.hex})})})})}),logColor(o.hex)}})}function logColor(e){console.log("%c "+e+" ","color: "+e)}function setStyles(e){return".subtitle-cue p, .example-subtitle-cue p {background: "+e.vs_background+" !important; color: "+e.vs_text+" !important;}"}chrome.storage.sync.get([vsBackground,vsText],function(e){initializeMessageListener(vsBackground,vsText,vsStyle),setManifestData(manifest),setMovieQuote(doc.querySelector(".example-subtitle-cue p"),movieQuotes),setPopupColors(vsStyle,e),initializeColorPicker(doc.querySelector("#background"),e.vs_background,vsBackground),initializeColorPicker(doc.querySelector("#text"),e.vs_text,vsText)});